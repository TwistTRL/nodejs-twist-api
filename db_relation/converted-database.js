
const SQL_MODEL_PERSONNEL = `
PERSONNEL AS (
SELECT /*+ INLINE */
  CHB_PRSNL_ID,
  NAME_FIRST,
  NAME_MIDDLE,
  NAME_LAST,
  SEX_CODE.VALUE AS SEX,
  BIRTH_UNIX_TS,
  DECEASED_UNIX_TS
FROM CHB_PRSNL
  JOIN PERSON USING(PERSON_ID)
  JOIN SEX_CODE USING(SEX_CD)
)
`;


const SQL_MODEL_PERSONNEL_BED_ASSIGNMENT = `
PERSONNEL_BED_ASSIGNMENT AS (
SELECT /*+ INLINE */
  BED_ASSIGN_ID AS "__ID__",
  CHB_PRSNL_ID,
  BED_CD,
  ASSIGN_TYPE_CODE.VALUE AS ASSIGN_TYPE,
  START_UNIX_TS,
  END_UNIX_TS
FROM CHB_TRK_BED_ASSIGN
  JOIN CHB_TRK_ASSIGN USING(ASSIGN_ID)
  JOIN ASSIGN_TYPE_CODE USING(ASSIGN_TYPE_CD)
)
`;

const SQL_MODEL_BED = `
BED AS (
SELECT /*+ INLINE */
  BED_CD,
  ROOM_CD,
  VALUE AS NAME
FROM BED_CODE
)
`;

const SQL_MODEL_PATIENT_BED_ASSIGNMENT = `
PATIENT_BED_ASSIGNMENT AS (
SELECT /*+ INLINE */
  ENCNTR_BED_SPACE_ID,
  ENCNTR_ID,
  BED_CD,
  START_UNIX_TS,
  END_UNIX_TS  
FROM ENCNTR_BED_SPACE
)
`;

const SQL_MODEL_PATIENT_ENCOUNTER = `
PATIENT_ENCOUNTER AS (
SELECT /*+ INLINE */
  ENCNTR_ID,
  PERSON_ID,
  ENCNTR_TYPE_CODE.VALUE AS ENCOUNTER_TYPE,
  ARRIVE_UNIX_TS,
  DEPART_UNIX_TS
FROM ENCOUNTER
  JOIN ENCNTR_TYPE_CODE USING(ENCNTR_TYPE_CD)
)
`;


const SQL_MODEL_PATIENT = `
PATIENT AS (
SELECT /*+ INLINE */
  PERSON_ID,
  NAME_FIRST,
  NAME_MIDDLE,
  NAME_LAST,
  SEX_CODE.VALUE AS SEX,
  BIRTH_UNIX_TS,
  DECEASED_UNIX_TS
FROM PERSON
  JOIN SEX_CODE USING(SEX_CD)
)
`;

const SQL_MODEL_ROOM = `
ROOM AS (
SELECT /*+ INLINE */
  ROOM_CD,
  NURSE_UNIT_CD,
  VALUE AS NAME
FROM ROOM_CODE
)
`;

module.exports = {
    SQL_MODEL_PERSONNEL,
    SQL_MODEL_PERSONNEL_BED_ASSIGNMENT,
    SQL_MODEL_BED,
    SQL_MODEL_PATIENT_BED_ASSIGNMENT,
    SQL_MODEL_PATIENT_ENCOUNTER,
    SQL_MODEL_PATIENT,
    SQL_MODEL_ROOM
}